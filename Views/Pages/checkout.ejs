<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CheckOut</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/style1.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
  <header>
    <nav>
        <div class="brand text-white">
            <div class="brand-name">
                <h4>Shoppin</h4>
                <!-- <i cla></i> -->
            </div>
            <div class="toggle_btn">

            </div>
        </div>
        
        <div class="links text-white">
                
          <a href="#" class="show-cart-btn" data-id="1"><i class="bi bi-cart4"></i> Cart</a>
      </div>
    </nav>
</header>
<%- include('../snackbar.ejs')%>
<section>
    
  <div class="floating-cart" id="floatingCart">
      <div class="cart-header">
          <h2>Cart</h2>
          <i class="bi bi-x close-cart-btn"></i>
      </div>
    
      <div class="cart-body">
          <div class="cart-item">
              <div class="cart-item-header">
                  <img src="images/watches/Calvin Klein Men's Minimal Quartz.jpg" alt="Product 1">
              </div>
              <div class="cart-item-body">
                  <h6 class="item-name">Calvin Klein</h6>
                  <p class="item-price">$20.00</p>
                  <div class="item-quantity">
                      <div class="quantity-btn add-quantity" onclick="updateQuantity(this, -1)">-</div>
                      <span class="quantity">1</span>
                      <div class="quantity-btn decrease-quantity" onclick="updateQuantity(this, 1)">+</div>
                  </div>
              </div>
          </div>
          
          <div class="cart-item">
              <div class="cart-item-header">
                  <img src="images/assets/ring1.png" alt="Product 1">
              </div>
              <div class="cart-item-body">
                  <h6 class="item-name">Diamond Ring</h6>
                  <p class="item-price">$15.00</p>
                  <div class="item-quantity">
                      <div class="quantity-btn add-quantity" onclick="updateQuantity(this, -1)">-</div>
                      <span class="quantity">1</span>
                      <div class="quantity-btn decrease-quantity" onclick="updateQuantity(this, 1)">+</div>
                  </div>
              </div>
          </div>
          
      
      </div>
      <div class="cart-footer">
        <div class="cart-total">Cart Total: <span class="amount-details" id="total_Amount">$0.00</span></div>
        <a href="#" class="checkout-btn">Checkout</a>
      </div>
    </div>
  </div>
</section>
    <div class="main-checkout-container">

     

        <!-- Sub-Container 1 -->
        <form action="#" method="post" class="sub-container" id="checkoutForm">
          <h2>Checkout</h2>

          <a href="#" class="back-to-shopping-link">Back to Shopping</a>
           <!---->  
          
          <div class="shipping-info shipping-details">
            <h3>Shipping Details</h3>
            <p id="shippingAddress">Shipping Address: <span>123 Main St</span></p>
            <p id="shippingMethod">Shipping Method: <span>Standard Shipping</span></p>
            <a href="#" class="edit-link" onclick="editDetails('shippingAddress', 'shippingMethod')">Edit</a>
          </div>
        
          
        
          <div class="shipping-info delivery-details">
            <h3>Delivery Details</h3>
            <p id="deliveryDate">Estimated Delivery Date: <span >January 30, 2024</span></p>
            <p id="deliveryStatus">Delivery Status: <span>In Transit</span></p>
            <a href="#" class="edit-link" onclick="editDetails('deliveryDate', 'deliveryStatus')">__</a>
          </div>
        
         
        
          <div class="shipping-info payment-details">
            <h3>Payment Details</h3>
            <p id="paymentMethod">Payment Method: <span>Credit Card</span></p>
            <p id="totalAmount">Total Amount: <span>$100.00</span></p>
            <a href="#" class="edit-link" onclick="editDetails('paymentMethod', 'totalAmount')">__</a>
          </div>
 
  <h3>Everything look good?</h3>
  <div class="button-section">
    <div class="control-btns">
      <button class="add-to-cart" data-user="1" data-productId=<%=item.itemId %>  ><i class="bi bi-cart-plus-fill"></i> Cart</button>
      <button type="button" class="button-33" onclick="placeOrder()" role="button">Place Order</button>
    </div>
  </div>
</form>
    
        <!-- Sub-Container 2 -->
        <div class="sub-container">
          <h2>Order Summary</h2>
          <div class="checkout-info">
            <div class="checkout-header">
              <img src=<%=item.itemImage %> alt="">
            </div>
            <div class="checkout-body">
              <div class="amount-details subtotal">
                <span class="label"><strong>Item:</strong></span>
                <span class=""> <%=item.itemName %></span>
              </div>
              <div class="amount-details subtotal">
                <span class="label"><strong>Type:</strong></span>
                <span class=""> <%=item.itemType %></span>
              </div>
              <div class="amount-details subtotal Description">
                <span class="label"><strong>Description:</strong></span>
                <span class=""> <%=item.itemDescription %></span>
              </div>
              
              <div class="amount-details subtotal">
                <span class="label"><strong>Subtotal:</strong></span>
                <span class="amount">$<span id="subtotalAmount"><%=item.itemPrice %></span> </span>
              </div>
              <div class="amount-details shipping">
                <span class="label"><strong>Shipping:</strong></span>
                <span class="amount">$5.00</span>
              </div>

              <div class="amount-details estimated-total">
                <span class="label"><strong>Estimated Total:</strong></span>
                <span class="amount">$<span id="estimatedTotalAmount"></span></span>
              </div>
            </div>
          </div>
          

          <div id="editDetailsModal" class="modal">
            <div class="modal-content">
              <span class="close">&times;</span>
              <h2>Edit Details</h2>
              <form id="editDetailsForm">
                <!-- Add form fields for editing details -->
                <label for="newShippingAddress">Shipping Address:</label>
                <input type="text" id="newShippingAddress" name="newShippingAddress" required>
          <br>
          <br>
          
          <button type="submit" id="saveChangesBtn" class="button">Save Changes</button>

              </form>
            </div>
          </div>
              
              

          
          </div>
      </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

      <script src="/script.js"></script>
      <script>
/*pop up*/
var modal = document.getElementById("editDetailsModal");

var editLink = document.getElementsByClassName("edit-link")[0];

var span = document.getElementsByClassName("close")[0];

editLink.onclick = function() {
  modal.style.display = "block";
}

span.onclick = function() {
  modal.style.display = "none";
}

window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}

document.getElementById("editDetailsForm").addEventListener("submit", function(event) {
  event.preventDefault(); 

  var newShippingAddress = document.getElementById("newShippingAddress").value;

  document.getElementById("shippingAddress").querySelector('span').textContent = newShippingAddress;
 
  modal.style.display = "none";
});



           document.addEventListener("DOMContentLoaded", function() {
        // Get the subtotal amount from the page
        var subtotalAmount = parseFloat(document.querySelector('.subtotal .amount').innerText.replace('$', ''));

        // Get the shipping amount from the page
        var shippingAmount = parseFloat(document.querySelector('.shipping .amount').innerText.replace('$', ''));

        // Calculate the estimated total
        var estimatedTotal = subtotalAmount + shippingAmount;

        // Update the subtotal amount on the page
        document.getElementById('subtotalAmount').innerText = subtotalAmount.toFixed(2);

        // Update the estimated total on the page
        document.getElementById('estimatedTotalAmount').innerText = estimatedTotal.toFixed(2);
    });
    function updateQuantity(element, change) {
        // Find the parent cart-item
        var cartItem = element.closest('.cart-item');

        // Find the item price and quantity elements
        var itemPriceElement = cartItem.querySelector('.item-price');
        var quantityElement = cartItem.querySelector('.quantity');

        // Get the current item price and quantity
        var itemPrice = parseFloat(itemPriceElement.innerText.replace('$', ''));
        var quantity = parseInt(quantityElement.innerText);

        // Update the quantity
        quantity += change;

        // Ensure quantity is at least 1
        quantity = Math.max(1, quantity);

        // Update the quantity element
        quantityElement.innerText = quantity;

        // Calculate the new total price
        var totalPrice = itemPrice * quantity;

        // Update the total price in the cart-total element
        updateCartTotal();
    }

    function updateCartTotal() {
        // Find all cart-item elements
        var cartItems = document.querySelectorAll('.cart-item');

        // Initialize total price
        var totalPrice = 0;

        // Iterate over each cart item and sum their total prices
        cartItems.forEach(function(cartItem) {
            var itemPriceElement = cartItem.querySelector('.item-price');
            var quantityElement = cartItem.querySelector('.quantity');

            var itemPrice = parseFloat(itemPriceElement.innerText.replace('$', ''));
            var quantity = parseInt(quantityElement.innerText);

            totalPrice += itemPrice * quantity;
        });

        // Find the cart-total element
        var cartTotalElement = document.querySelector('.cart-total .amount-details');

        // Update the content of the cart-total element
        cartTotalElement.innerText = '$' + totalPrice.toFixed(2);

    }
      </script>
</body>
</html>